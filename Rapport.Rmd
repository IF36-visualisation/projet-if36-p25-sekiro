---
title: "World Population Prospects Stats (1950 - 2100)"
author: "IF36 - SEKIRO (Othmane BEKKAL, Nicolas RIGOLAT, Robin NADAL, Zakaria ZAROUAL)"
date: "UTT - P25"
output:
  html_document: default
  pdf_document: default
---
![](./images/Logo_of_the_United_Nations.png)

## Table des matières

> [Introduction](#section-1) <br> [I. Données](#section-2) <br> [II. Plan d'analyse](#section-3) <br> [III. Exploration](#section-4) <br> [IV. Annexe](#section-5) <br>

<a id="section-1"></a>

# Introduction
&ensp;Nous avons choisi d’utiliser le jeu de données **“World Population Prospects”**, mis à disposition par l’**Organisation des Nations Unies** via leur site officiel : [https://population.un.org/wpp](https://population.un.org/wpp)

&ensp;Ce dataset est mis à jour tous les 2 ans environ, la version utilisée sera la dernière, celle de 2024. Plus précisément, ces documents sont édités et publiés par le **DAES** (DESA en anglais), le *Département des Affaires Économiques et Sociales* qui est un “secrétariat” (un organisme principal) de l’ONU qui produit et analyse des datasets afin de produire des rapports et aide les pays à prendre des décisions et à avoir des agendas de politiques au fait des enjeux sociétaux et économiques. Les rapports publics portent par exemple sur l’avancement des droits des femmes, de la jeunesse, des autochtones, mais aussi sur l’état et les objectifs futurs des forêts, des énergies renouvelables, de l’économie et donc aussi de la démographie.

&ensp;Ces données contiennent des projections démographiques standardisées pour l’ensemble des pays du monde, couvrant la période de **1950 à 2100**. Les données de 1950 à 2023 sont des données issues de recensement de 238 pays/régions non-autonomes. Ce dataset constitue donc une source fiable, riche, et particulièrement pertinente dans un contexte de réflexion sur l’évolution des sociétés.

<a id="section-2"></a>

# I. Données

Notre dataset est constitué de 15 fichiers CSV thématiques couvrant l'évolution démographique mondiale sous différentes facettes : population totale, fécondité, mortalité, migration, et bien d'autres. Il propose une exploration à travers quatre niveaux de granularité spatiale : mondial, régional, national, et urbain/rural. Les données sont également regroupées par tranches d'âge quinquennales, permettant une analyse fine de l'évolution au fil du temps.

De plus, trois scénarios prospectifs (bas, moyen, haut) ont été élaborés selon les politiques natalistes des États, projetant ainsi plusieurs futurs possibles pour l'humanité.  
Ce vaste ensemble contient **84 360 observations** réparties sur **42 variables**, offrant une base solide pour comprendre les dynamiques démographiques passées, présentes et futures.

Chaque localisation est identifiée de manière unique, facilitant l'agrégation, la comparaison et l'interprétation des différentes séries temporelles disponibles.

<details>
<summary><b><font size="+1">Description des variables du dataset</font></b></summary>

| Colonne         | Format      | Type de données | Description |
|-----------------|-----------|-----------------|-------------|
| **SortOrder**            | int      | Discrète | Ordre des lignes |
| **LocID**                | int      | Discrète | Identifiant unique de la localisation |
| **Notes**                | string (nullable) | Nominale | Informations additionnelles |
| **ISO3_code**            | string (nullable) | Nominale | Code pays en 2 lettres selon la norme ISO 3166-1 alpha-3 |
| **ISO2_code**            | string (nullable) | Nominale | Code pays en 2 lettres selon la norme ISO 3166-1 alpha-2 |
| **SDMX_code**            | string (nullable) | Nominale | Code SDMX pour la localisation |
| **LocTypeID**            | int      | Discrète | Type de la localisation |
| **LocTypeName**          | string   | Nominale | Nom du type de localisation |
| **ParentID**             | int (nullable) | Discrète | Identifiant du parent (si la localisation fait partie d'une région) |
| **Location**             | string   | Nominale | Nom de la région/localisation |
| **VarID**                | int      | Discrète | Identifiant de la variable |
| **Variant**              | string   | Nominale | Type de scénario démographique (ex. Medium) |
| **Time**                 | int      | Ordinale | Année |
| **TPopulation1Jan**      | float    | Continue | Population totale au 1er janvier |
| **TPopulation1July**     | float    | Continue | Population totale au 1er juillet |
| **TPopulationMale1July** | float    | Continue | Population masculine au 1er juillet |
| **TPopulationFemale1July** | float | Continue | Population féminine au 1er juillet |
| **PopDensity**           | float    | Continue | Densité de population (habitants/km²) |
| **PopSexRatio**          | float    | Continue | Ratio hommes/femmes |
| **MedianAgePop**         | float    | Continue | Âge médian de la population |
| **NatChange**           | float    | Continue | Changement naturel de la population |
| **NatChangeRT**         | float    | Continue | Taux de changement naturel |
| **PopChange**           | float    | Continue | Changement total de la population |
| **PopGrowthRate**       | float    | Continue | Taux de croissance démographique |
| **DoublingTime**        | float    | Continue | Temps de doublement de la population |
| **Births**              | float    | Continue | Nombre total de naissances |
| **Births1519**          | float    | Continue | Naissances chez les 15-19 ans |
| **CBR**                 | float    | Continue | Taux brut de natalité (pour 1000 habitants) |
| **TFR**                 | float    | Continue | Taux de fécondité total (nombre moyen d'enfants par femme) |
| **NRR**                 | float    | Continue | Taux net de reproduction |
| **MAC**                 | float    | Continue | Âge moyen de la maternité |
| **SRB**                 | float    | Continue | Ratio de masculinité à la naissance (nombre de garçons pour 100 filles) |
| **Deaths**              | float    | Continue | Nombre total de décès |
| **DeathsMale**          | float    | Continue | Nombre de décès masculins |
| **DeathsFemale**        | float    | Continue | Nombre de décès féminins |
| **CDR**                 | float    | Continue | Taux brut de mortalité (pour 1000 habitants) |
| **LEx**                 | float    | Continue | Espérance de vie à la naissance |
| **LExMale**             | float    | Continue | Espérance de vie des hommes |
| **LExFemale**           | float    | Continue | Espérance de vie des femmes |
| **LE15**                | float    | Continue | Espérance de vie à 15 ans |
| **LE15Male**            | float    | Continue | Espérance de vie des hommes à 15 ans |
| **LE15Female**          | float    | Continue | Espérance de vie des femmes à 15 ans |
| **LE65**                | float    | Continue | Espérance de vie à 65 ans |
| **LE65Male**            | float    | Continue | Espérance de vie des hommes à 65 ans |
| **LE65Female**          | float    | Continue | Espérance de vie des femmes à 65 ans |
| **LE80**                | float    | Continue | Espérance de vie à 80 ans |
| **LE80Male**            | float    | Continue | Espérance de vie des hommes à 80 ans |
| **LE80Female**          | float    | Continue | Espérance de vie des femmes à 80 ans |
| **InfantDeaths**        | float    | Continue | Nombre de décès infantiles |
| **IMR**                 | float    | Continue | Taux de mortalité infantile (pour 1000 naissances vivantes) |
| **LBsurvivingAge1**     | float    | Continue | Nombre d'enfants survivant jusqu'à 1 an |
| **Under5Deaths**        | float    | Continue | Nombre de décès avant 5 ans |
| **Q5**                  | float    | Continue | Probabilité de mourir avant 5 ans |
| **Q0040, Q0040Male, Q0040Female** | float | Continue | Probabilité de mourir entre 0 et 40 ans (total, hommes, femmes) |
| **Q0060, Q0060Male, Q0060Female** | float | Continue | Probabilité de mourir entre 0 et 60 ans (total, hommes, femmes) |
| **Q1550, Q1550Male, Q1550Female** | float | Continue | Probabilité de mourir entre 15 et 50 ans (total, hommes, femmes) |
| **Q1560, Q1560Male, Q1560Female** | float | Continue | Probabilité de mourir entre 15 et 60 ans (total, hommes, femmes) |
| **NetMigrations**       | float    | Continue | Migration nette (immigrants - émigrants) |
| **CNMR**               | float    | Continue | Taux net de migration (pour 1000 habitants) |

</details>

<a id="section-3"></a>

# II. Plan d'analyse

Ce jeu de données permet d’étudier en profondeur les dynamiques démographiques mondiales, passées et futures. Notre objectif principal est d’en extraire des tendances visuelles à l’échelle globale, régionale et nationale, et de les mettre en relation avec des enjeux actuels (vieillissement, natalité…).


### 1. Dynamiques démographiques différentielles
  L’objectif de cette partie sera principalement d’observer les trajectoires démographiques historiques (1950-2023) et projetées (2024-2100) à travers les trois scénarios SSP. Il s’agira à la fois de visualiser par région l’évolution démographique mais aussi de visualiser les 3 scénarios du futur démographique (SSP1, SSP2, SSP3). On se servira de line charts multiples pour chercher des croissances et décroissances.

### 2. Natalité, fécondité et Santé
  L’un des piliers de la démographie est la natalité. Nous chercherons à comprendre comment elle a évolué au cours des 70 dernières années en analysant le Total Fertility Rate (TFR). Nous examinerons également la corrélation entre la mortalité infantile et la fécondité, en croisant ces données avec celles des grossesses adolescentes.

### 3. Structure par âge et dividende démographique
  Nous chercherons à comprendre à quel moment une population entre dans une phase de dividende démographique, lorsque la part de la population en âge de travailler (15–64 ans) dépasse largement celle des jeunes (0–14 ans) et des personnes âgées (65+). L’analyse portera sur l’évolution de la structure par âge au cours du temps, afin d’identifier les pays qui bénéficient ou bénéficieront d’une fenêtre démographique favorable à la croissance et au développement.

<a id="section-4"></a>

# III. Exploration

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)
library(gridExtra)
library(tidyverse)
library(plotly)
library(RColorBrewer)
library(readr)
library(scales)
library(countrycode)
library(ggimage)
```

### 1. Comment le taux de fécondité total (TFR) a-t-il évolué entre 1950 et 2023 dans les cinq continents ?

Nous supposons que le TFR a globalement diminué sur tous les continents depuis 1950 avec des disparités régionales marquées (ex : déclin plus rapide en Europe qu'en Afrique). Le taux de fécondité total est le nombre d'enfant vivant à la naissance par femme. On ne compte pas ici l'indice de survie des enfants. Nous respecterons la division en continent de l'Amérique en quatre entités (South America, Central America, the Caribbean, and Northern America) faite par l'ONU dans ce dataset.

```{r echo=FALSE}
Dem_1950_2023 <- read_excel("./data/Dem_1950-2023.xlsx")
data <- Dem_1950_2023
data_clean <- data %>%
  rename_with(tolower) %>%
  rename(
    year = `...11`,
    continent = `...3`,
    tfr = `...27`
  ) %>%
  filter(!is.na(year), !is.na(continent), !is.na(tfr)) %>%
  mutate(
    year = as.integer(year),
    tfr = as.numeric(tfr)
  ) %>% filter(continent %in% c("Africa", "Asia", "Europe", "Northern America", "Caribbean", "Central America", "South America", "Oceania"))
ggplot(data_clean, aes(x = year, y = tfr, color = continent)) +
  geom_line(size = 1.2) +
  geom_hline(yintercept=2.05,
             color="black",
             size=1)+
  labs(title = "Évolution du taux de fécondité total (TFR) par continent",
       x = "Année",
       y = "Taux de fécondité total (TFR)",
       color = "Continent",
       caption="Le seuil de renouvellement générationel est représenté par la ligne horizontale noire") +
  theme_minimal() +
  scale_x_continuous(breaks = c(seq(1950,2020, by=5)))+
  scale_y_continuous(expand = c(0,0), limits = c(0,7.5), breaks = c(seq(0,8, by=1)))+
  theme(
    plot.title = element_text(size = 14, face = "bold", hjust = 0.5),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 10)
  )

```


La baisse globale du TFR, passant de 4,7 en 1950 à 2,3 en 2023, dissimule des réalités hétérogènes en fonction du continent.

&emsp; La transition démographique explique le basculement historique des sociétés : d'un régime démographique ancestral (forte natalité compensant une mortalité infantile élevée) vers un modèle moderne (faible mortalité et natalité maîtrisée). Ce processus en quatre phases :
1. Équilibre précaire (TFR>6)
2. Chute de la mortalité (explosion démographique)
3. Baisse différée de la natalité (TFR vers 2,1)
4. Nouvel équilibre à bas niveau (vieillissement) – éclaire les écarts continentaux observés
&emsp; Bien sûr ,les politiques coercitives (politique nataliste) ou les chocs historiques (famines) accélèrent artificiellement les phases. Certaines régions (Afrique subsaharienne) connaissent un blocage en phase 2 par manque d'éducation féminine. Les sociétés post-industrielles (Corée du Sud, Italie) entrent dans une phase 5 non théorisée et inédite, une dépopulation structurelle et continue même en présence de politique.


&emsp; En Afrique, le TFR a connu un déclin relatif mais inachevé, diminuant de 6,7 à 4,3 sur 73 ans. Cette transition lente peut s'expliquer par la persistance de normes pro-natalistes, par un accès limité à la contraception, la baisse faible de la mortalité infantile, divisée par quatre depuis 1950 qui n’a pas encore entraîné un ajustement proportionnel des comportements reproductifs (la seconde phase de la transition démographique).
&emsp; Le continent est bloqué en phase 2 (mortalité infantile en baisse sans adaptation de la natalité). L’absence de chute brutale du TFR retarde l’entrée en phase 3, risquant un "dividende démographique manqué" si la croissance économique ne suit pas la jeunesse de la population – illustrant le blocage critique du modèle en Afrique subsaharienne.

&emsp; En Europe, le TFR a continuellement baissé dès les années 1970 pour atteindre 1,5 en 2023. L'Europe est sous le seuil de renouvellement depuis 1975, sans immigration la population aurait largement diminué.
&emsp; Le continent a achevé sa phase 4 (équilibre basse natalité/basse mortalité). Son enjeu est désormais la "détransition démographique" : incapacité structurelle à remonter le TFR au seuil de renouvellement, accélérant le vieillissement et la dépendance à l’immigration. Le maintient de la population est le chalenge signature de la phase 5 des sociétés post-industrielles oocidentale.

&emsp;  On peut voir des données intéressantes des années 1950 à 1975. Si l'Amérique du Sud a une baisse continue et linéaire, l'Asie connaît des rebonds et de fortes baisses. En effet, l'année 1961, celle de la plus grande baisse, peut être corrélée avec la Grande famine chinoise (1959-1961). Mais sous cette moyenne se cache de grande disparité : dans six pays (Chine, Corée du Nord, Corée du Sud, Japon, Singapour, Thaïlande), la transition de la fécondité est largement achevée avec un nombre moyen d’enfants par femme qui est désormais inférieur au seuil de remplacement des génération. Le Japon, Singapour et la Corée du Sud se caractérisent même par des niveaux de fécondité parmi les plus bas au monde, inférieurs à 1,4 enfant par femme (faisant d’eux des ‘lowest-low’ fertility countries). La Chine, grâce à sa politique coercitive de l’enfant unique, a évité 400 millions de naissances, mais au prix d’un déséquilibre de genre historique. L’Inde, via des campagnes volontaristes comme "Us two, our two" (un couple, deux enfants), a réduit son TFR de 5,7 à 2,0.
&emsp; La région vit une phase 3 accélérée et traumatique (politiques coercitives) avec entrée prématurée en phase 4 (Japon, Corée du Sud). Les chocs historiques (famines) ont perturbé la baisse naturelle de la fécondité, créant des déséquilibres durables. La Corée du Sud (TFR 0,72) incarne désormais la phase 5 la plus avancée.

&emsp; L’Océanie, avec un TFR moyen de 2,1, cache des fractures invisibles. L’Australie et la Nouvelle-Zélande (1,6) contrastent avec la Mélanésie, où la Papouasie-Nouvelle-Guinée maintient un TFR de 3,2. 
&emsp; Dualité de phase : Australie/NZ en phase 4 (vieillissement avancé), Mélanésie en fin de phase 2 (mortalité infantile en baisse mais natalité résiliente).

&emsp; Du côté des Amériques, deux schémas sont présents. L'Amérique du Nord (Northen America ou Amérique septentrionale) composé des États-Unis, du Canada ainsi que des Bermudes (Royaume-Uni), du  Groenland (Danemark) et de Saint-Pierre-et-Miquelon (France), suit une courbe très proche de celle de l'Europe. Le reste des Amériques; centrale, du sud et les Caraïbes ; suivent une trajectoire similaire à l'Asie avec une baisse qui les emmène tous en dessous du seuil de renouvellement.
&emsp; Amérique du Nord : Transition achevée en phase 4 (profil européen), compensée par l’immigration. Amérique latine/Caraïbes : Phase 3 la plus rapide de l’histoire (urbanisation + planning familial), mais risque de "vieillissement sans prospérité" – défi typique des phases accélérées sans consolidation économique dans le temps.

### 2. Quels sont les 10 pays ayant connu les plus fortes croissances et décroissances démographiques entre 1950 et 2023 ?


```{r echo=FALSE}
#Data from excel
load_and_clean_data <- function() {
  file_path <- "data/Dem_1950-2023.xlsx"
  
  data_estimates <- read_excel(file_path, sheet = "Estimates")
  colnames(data_estimates) <- as.character(data_estimates[12, ])
  
  data_clean <- data_estimates[-(1:12), ] %>% 
    rename(
      Country = `Region, subregion, country or area *`,
      Population = `Total Population, as of 1 January (thousands)`
    ) %>%
    mutate(
      Year = as.character(Year),
      Population = as.numeric(Population)
    )
  
  return(data_clean)
}

filter_countries_only <- function(data) {
  data %>% filter(grepl("^[A-Za-z]", Country))
}

# Calcule var
calculate_population_growth <- function(data) {
  data %>%
    filter(Year %in% c("1950", "2023")) %>%
    group_by(Country, Year) %>%
    summarize(Population = sum(Population, na.rm = TRUE)) %>%
    ungroup() %>%
    pivot_wider(
      names_from = Year,
      values_from = Population,
      names_prefix = "Population_"
    ) %>%
    mutate(
      Population_1950 = as.numeric(Population_1950),
      Population_2023 = as.numeric(Population_2023),
      Population_Change = Population_2023 - Population_1950,
      Percent_Change = ((Population_2023 - Population_1950) / Population_1950) * 100
    ) %>%
    filter(complete.cases(.))
}

get_distinct_colors <- function(n) {
  colorRampPalette(brewer.pal(12, "Set3"))(n)
}

common_theme <- function() {
  theme_minimal() +
    theme(
      axis.text.x = element_text(angle = 45, hjust = 1, size = 8, color = "black"),
      axis.text.y = element_text(size = 8, color = "black"),
      axis.title = element_text(size = 10, color = "black", face = "bold"),
      legend.title = element_text(size = 9, face = "bold"),
      legend.text = element_text(size = 8),
      plot.title = element_text(size = 12, hjust = 0.5, face = "bold"),
      panel.grid.major = element_line(color = "gray90", linewidth = 0.2),
      panel.grid.minor = element_blank()
    )
}

# Barres
create_styled_bar_plot <- function(data, title, y_label, fill_color) {
  p <- ggplot(data, aes(x = reorder(Country, Percent_Change), y = Percent_Change, 
                        text = paste("Pays:", Country, "<br>Changement:", round(Percent_Change, 1), "%"))) +
    geom_bar(stat = "identity", fill = fill_color, color = "black", size = 0.2, width = 0.7) +
    common_theme() +
    labs(title = title, x = "Pays", y = y_label)
  
  ggplotly(p, tooltip = "text") %>%
    layout(
      legend = list(
        bgcolor = "white",
        bordercolor = "black",
        borderwidth = 1,
        title = list(text = "Pays")
      ),
      hoverlabel = list(
        bgcolor = "white",
        font = list(size = 10)
      )
    )
}
# Graph en ligne
create_styled_line_plot <- function(data, title) {
  countries <- unique(data$Country)
  colors <- get_distinct_colors(length(countries))
  names(colors) <- countries
  
  p <- ggplot(data, aes(x = as.numeric(Year), y = Population_Relative, 
                       color = Country, group = Country,
                       text = paste("Pays:", Country, "<br>Année:", Year, 
                                  "<br>Population:", round(Population_Relative, 1), "%"))) +
    geom_line(size = 1) +
    geom_hline(yintercept = 100, linetype = "dashed", color = "gray50") +
    scale_color_manual(values = colors) +
    scale_x_continuous(breaks = seq(1950, 2023, by = 10)) +
    scale_y_continuous(labels = scales::percent_format(scale = 1)) +
    common_theme() +
    labs(
      title = title,
      x = "Année",
      y = "Population (% relative à 1950)",
      color = "Pays"
    )
  
  ggplotly(p, tooltip = "text") %>%
    layout(
      legend = list(
        bgcolor = "white",
        bordercolor = "black",
        borderwidth = 1,
        title = list(text = "Pays")
      ),
      hoverlabel = list(
        bgcolor = "white",
        font = list(size = 10)
      )
    )
}

# Execution
data_clean <- load_and_clean_data()
data_countries <- filter_countries_only(data_clean)
data_growth <- calculate_population_growth(data_countries)

top_countries <- data_growth %>% 
  arrange(desc(Percent_Change)) %>% 
  head(10) %>% 
  pull(Country)

bottom_countries <- data_growth %>% 
  arrange(Percent_Change) %>% 
  head(10) %>% 
  pull(Country)

# Donnes relative
prepare_relative_data <- function(data_clean, countries) {
  data_clean %>%
    filter(Country %in% countries) %>%
    group_by(Country) %>%
    mutate(
      Base_1950 = Population[Year == "1950"],
      Population_Relative = ((Population / Base_1950) * 100) - 100
    ) %>%
    ungroup() %>%
    filter(!is.na(Population_Relative))
}

# Graph
top_growth_bar <- create_styled_bar_plot(
  data_growth %>% filter(Country %in% top_countries),
  "Top 10 Croissance Démographique Relative (1950-2023)",
  "Changement (%)",
  "#66C2A5"
)

bottom_decline_bar <- create_styled_bar_plot(
  data_growth %>% filter(Country %in% bottom_countries),
  "Top 10 Décroissance Démographique Relative (1950-2023)",
  "Changement (%)",
  "#FC8D62"
)

# Donnes graphes en lignes
top_data_rel <- prepare_relative_data(data_clean, top_countries)
bottom_data_rel <- prepare_relative_data(data_clean, bottom_countries)

top_growth_line <- create_styled_line_plot(
  top_data_rel,
  "Évolution Relative des 10 Pays avec \nla Plus Forte Croissance (1950-2023)"
)

bottom_decline_line <- create_styled_line_plot(
  bottom_data_rel,
  "Évolution Relative des 10 Pays avec \nla Plus Forte Décroissance (1950-2023)"
)


```

Dans cette partie, nous allons nous intéresser à la question suivante : 
Quels sont les 10 pays ayant connu les plus fortes croissances et décroissances démographiques entre 1950 et 2023 ?

Pour y répondre, nous avons tout d'abord chargé et nettoyé les données issues du fichier Dem_1950-2023.xlsx, qui regroupe les estimations de population par pays et par année. Nous avons principalement utilisé trois variables : le nom du pays (Country), l'année d'estimation (Year, de 1950 à 2023) et la population totale au 1er janvier (Population, en milliers d’habitants). Après avoir filtré pour ne garder que les vrais pays, nous avons extrait la population de 1950 et celle de 2023 pour chacun d’eux. Cela nous a permis de calculer le changement absolu (différence brute) ainsi que le changement relatif (en pourcentage) de la population sur cette période.

Plutôt que de nous limiter à un calcul absolu de l'augmentation de population qui aurait favorisé mécaniquement les pays les plus peuplés nous avons choisi d'analyser la croissance relative.
Cette approche nous permet de mieux saisir l'intensité des transformations démographiques, indépendamment de la taille initiale des pays.

```{r echo=FALSE, message=FALSE, warning=FALSE}
top_growth_bar
bottom_decline_bar
```

En observant les deux graphiques, on peut dire qu'ils répondent bien à la question posée : analyser les pays ayant connu la plus forte croissance et décroissance démographique relative entre 1950 et 2023. Le premier graphique, avec une échelle horizontale sur le changement en pourcentage, montre que des pays comme les Émirats Arabes Unis (+14 000%) et le Qatar, dont la forte augmentation démographique peut être attribuée à des facteurs économiques tels que l’exploitation des ressources pétrolières, attirant ainsi une immigration massive. À l’inverse, le graphique de décroissance met en évidence des pays comme Montserrat (-66%) ou Niue (-59%),  où la diminution de population semble être liée à des catastrophes naturelles ou une émigration importante.
Cependant, ces graphiques soulèvent également de nouvelles questions. Par exemple, l’exemple de l’Ukraine, avec une croissance  très modérée, pointe les effets des conflits géopolitiques sur les dynamiques démographiques

Enfin, ces graphiques invitent à une réflexion sur l’évolution temporelle des populations. En étudiant plus en profondeur les changements démographiques sur plusieurs décennies, on pourrait comprendre précisément à quel moment ces transformations ont eu lieu, en fonction des événements mondiaux ou locaux. 

```{r echo=FALSE, message=FALSE, warning=FALSE}
top_growth_line
bottom_decline_line

```
En observant les graphiques en lignes des pays à forte croissance, on remarque que le Qatar et les Émirats Arabes Unis (UAE) ont vu leur population exploser après les années 1970. Cela pourrait être lié à l'exploitation des ressources pétrolières, attirant une main-d'œuvre étrangère.

Concernant la décroissance démographique, l’Ukraine présente une tendance intéressante : après une légère croissance jusqu’en 1994, le déclin démographique s’est intensifié après 1991, potentiellement en raison de l'effondrement soviétique et de la crise économique qui en a résulté. La guerre récente pourrait expliquer l'accélération de cette décroissance à partir de 2021, avec des migrations forcées et une forte perte de population.La Lettonie, aussi issue de l'ex-URSS, montre une décroissance similaire après 1991

En conclusion, ces graphiques répondent bien à la question posée et permettent d'observer les évolutions démographiques mondiales entre 1950 et 2023. Ils mettent en lumière des pays ayant connu une croissance ou une décroissance démographique significative. Si l’on s’attendait à voir davantage de pays africains parmi les résultats, cela pourrait être dû à la période choisie. Une analyse sur des périodes plus récentes pourrait révéler des tendances démographiques plus marquées en Afrique.

### 3. Quels sont les 10 pays avec les taux de mortalité infantile les plus faibles et les plus élevés en moyenne entre 2000 et 2023 ?

Nous formulons l’hypothèse que le taux de mortalité infantile en 2023 est fortement corrélé au niveau de développement économique et sanitaire des pays.  
Les pays en développement, notamment d’Afrique subsaharienne, devraient présenter des taux élevés en raison d’un accès limité aux soins médicaux, à la vaccination, et à une nutrition adéquate.  
À l’inverse, les pays développés devraient afficher des taux très faibles, bénéficiant d’infrastructures de santé performantes, d’une meilleure hygiène de vie et d’une politique de prévention efficace.  
Nous nous attendons ainsi à observer un écart important entre les pays les plus riches et les pays les plus pauvres.

Afin de répondre à cette question, nous avons réalisé le graphique suivant à partir du jeu de données WPP 2024.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des bibliothèques nécessaires
library(readr)   
library(dplyr)   
library(ggplot2) 

# Chargement du fichier CSV
df <- read_csv("data/WPP2024_Demographic_Indicators_Medium.csv", show_col_types = FALSE)

# Filtrage sur la variante "Medium" et les années 2000 à 2023
df_infant <- df %>%
  filter(Variant == "Medium", Time >= 2000, Time <= 2023)

# Calcul de la moyenne du taux de mortalité infantile (IMR) par pays
df_infant_moyenne <- df_infant %>%
  group_by(Location) %>%
  summarise(moyenne_mortalite_infantile = mean(IMR, na.rm = TRUE))

# Sélection des 10 pays avec la mortalité infantile la plus élevée
top10_high <- df_infant_moyenne %>%
  arrange(desc(moyenne_mortalite_infantile)) %>%
  head(10)

# Sélection des 10 pays avec la mortalité infantile la plus faible
top10_low <- df_infant_moyenne %>%
  arrange(moyenne_mortalite_infantile) %>%
  head(10)

# Fusion des deux listes avec une colonne de catégorie
top20_2023 <- bind_rows(
  top10_high %>% mutate(Catégorie = "Taux élevé"),
  top10_low %>% mutate(Catégorie = "Taux faible")
)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Réalisation du graphique en barres
ggplot(top20_2023, aes(x = reorder(Location, moyenne_mortalite_infantile), y = moyenne_mortalite_infantile, fill = Catégorie)) +
  geom_col(width = 0.7) + # Barres
  geom_text(aes(label = round(moyenne_mortalite_infantile, 1)), hjust = -0.1, size = 3) + # Ajout des valeurs
  coord_flip(clip = "off") + # Inversion axes pour meilleure lisibilité
  scale_fill_manual(values = c("Taux élevé" = "#E63946", "Taux faible" = "#2A9D8F")) +
  labs(
    title = "Comparaison des taux de mortalité infantile (2000-2023)",
    x = "Pays",
    y = "Taux moyen de mortalité infantile (pour 1000 naissances vivantes)",
    fill = "Catégorie"
  ) +
  theme_minimal(base_family = "Arial") +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12),
    legend.title = element_text(size = 11),
    legend.text = element_text(size = 9),
    plot.margin = margin(10, 30, 10, 10)
  )

```
Le graphique met en évidence des écarts très marqués entre les pays en termes de mortalité infantile moyenne sur la période 2000-2023.  
On observe que les pays présentant les taux les plus élevés sont principalement situés en Afrique subsaharienne, comme la Sierra Leone, le Nigéria ou le Tchad.  
Ces taux élevés traduisent des défis persistants en matière d’accès aux soins prénatals, de couverture vaccinale, de nutrition infantile et d'infrastructures hospitalières.  
À l’inverse, les pays affichant les taux les plus faibles, tels que l’Islande, Singapour ou Hong Kong, disposent de systèmes de santé robustes, d’un suivi médical généralisé dès la naissance, ainsi que d’importants programmes de prévention et d’éducation sanitaire.  
Cet écart très marqué entre pays en développement et pays développés confirme notre hypothèse de départ : le niveau de développement économique, sanitaire et éducatif est un déterminant majeur du taux de mortalité infantile.  
Ces résultats soulignent aussi l'importance des politiques publiques de santé dans la réduction des inégalités sanitaires à l'échelle mondiale.

### 4. Quels sont les 10 pays représentant la plus forte part de la population mondiale en 2023 ?

Nous formulons l’hypothèse que la distribution de la population mondiale en 2023 est fortement concentrée dans quelques grands pays à forte démographie.  
Des pays comme la Chine, l’Inde, les États-Unis ou l’Indonésie devraient figurer parmi les principaux contributeurs à la population mondiale en raison de leur immense taille démographique historique et de leur dynamique de croissance soutenue.  
Nous nous attendons donc à observer une forte concentration de la population mondiale dans un nombre relativement restreint de pays.

Afin de répondre à cette question, nous avons réalisé le graphique suivant à partir du jeu de données **WPP 2024 (World Population Prospects)**, en se concentrant sur l’année 2023.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
install.packages("ggimage")
library(ggimage)

# Importation des données
data <- read_excel("data/Dem_1950-2023.xlsx", skip = 16)

# Nettoyage et sélection
data <- data %>%
  select(
    country = `Region, subregion, country or area *`,
    year = Year,
    total_pop = `Total Population, as of 1 July (thousands)`
  ) %>%
  mutate(
    total_pop = as.numeric(gsub(",", "", total_pop)),
    year = as.numeric(year)
  )

# Suppression des régions agrégées
data <- data %>%
  filter(!country %in% c(
    "World", "More developed regions", "Less developed regions",
    "Least developed countries", "Less developed regions, excluding least developed countries",
    "High-income countries", "Middle-income countries", "Upper-middle-income countries",
    "Lower-middle-income countries", "Low-income countries", "Low-and-middle-income countries",
    "Less developed regions, excluding China", "High-and-upper-middle-income countries",
    "Low-and-Lower-middle-income countries", "Europe, Northern America, Australia, and New Zealand",
    "Land-locked Developing Countries (LLDC)", "LLDC: Africa", "LLDC: Asia", "Sub-Saharan Africa",
    "Northern Africa and Western Asia", "Central and Southern Asia", "Eastern and South-Eastern Asia",
    "Latin America and the Caribbean", "Oceania", "Europe and Northern America", "Asia", "Africa",
    "Europe", "Northern America", "Caribbean", "Central America", "South America", "Eastern Europe",
    "Northern Europe", "Southern Europe", "Western Europe", "Eastern Africa", "Middle Africa",
    "Northern Africa", "Southern Africa", "Western Africa", "Western Asia", "Eastern Asia",
    "South-Eastern Asia", "Southern Asia", "Melanesia", "Micronesia", "Polynesia"
  ))

# Filtrage pour 2023
data_2023 <- data %>%
  filter(year == 2023) %>%
  mutate(working_age_share = (total_pop / sum(total_pop, na.rm = TRUE)) * 100)

# Top 10 des pays par part de population
top10 <- data_2023 %>%
  arrange(desc(working_age_share)) %>%
  head(10)

# Ajouter les URLs de drapeaux
top10 <- top10 %>%
  mutate(flag_url = case_when(
    country == "India" ~ "https://flagcdn.com/w80/in.png",
    country == "China" ~ "https://flagcdn.com/w80/cn.png",
    country == "United States of America" ~ "https://flagcdn.com/w80/us.png",
    country == "Indonesia" ~ "https://flagcdn.com/w80/id.png",
    country == "Pakistan" ~ "https://flagcdn.com/w80/pk.png",
    country == "Nigeria" ~ "https://flagcdn.com/w80/ng.png",
    country == "Brazil" ~ "https://flagcdn.com/w80/br.png",
    country == "Bangladesh" ~ "https://flagcdn.com/w80/bd.png",
    country == "Russian Federation" ~ "https://flagcdn.com/w80/ru.png",
    country == "Mexico" ~ "https://flagcdn.com/w80/mx.png",
    TRUE ~ NA_character_
  ))

# Palette personnalisée
custom_colors <- c(
  "India" = "#1b9e77", "China" = "#d95f02", "United States of America" = "#7570b3",
  "Indonesia" = "#e7298a", "Pakistan" = "#66a61e", "Nigeria" = "#e6ab02",
  "Brazil" = "#a6761d", "Bangladesh" = "#666666", "Russian Federation" = "#1f78b4",
  "Mexico" = "#b2df8a"
)

# Graphique final
ggplot(top10, aes(x = reorder(country, -working_age_share), 
                  y = working_age_share, 
                  fill = country)) +
  geom_col(width = 0.6, show.legend = FALSE) +
  geom_image(aes(image = flag_url), size = 0.06, nudge_y = 0.6) +
  geom_text(aes(label = sprintf("%.2f%%", working_age_share)), 
            vjust = -1.5, size = 3.5) +
  scale_fill_manual(values = custom_colors) +
  labs(
    title = "Top 10 des pays avec la plus forte part\nde population en 2023",
    x = "Pays",
    y = "Part de la population (%)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10)
  ) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25)))

```

Le graphique obtenu montre que la population mondiale est effectivement très concentrée dans quelques grands pays.
On observe que l’Inde et la Chine dominent largement, représentant à eux seuls une part considérable de la population mondiale, suivis par des pays comme les États-Unis, l’Indonésie, le Pakistan ou encore le Nigeria.

Cette forte concentration est le reflet de tendances historiques : natalité élevée dans certaines régions, urbanisation massive, dynamiques économiques diverses, et transitions démographiques différenciées selon les pays.




### 5. Quels pays connaîtront la plus forte croissance démographique entre 2023 et 2100 ?

Nous faisons l’hypothèse que les pays à plus forte croissance démographique d’ici 2100 seront majoritairement situés en **Afrique subsaharienne**, du fait d’un **taux de fécondité élevé**, d’une **population jeune**, et d’un **début de transition démographique plus récent**.  
Ces pays bénéficient en effet d’une **dynamique de croissance naturelle importante**, combinée à une **amélioration progressive des conditions de vie** (santé, éducation, urbanisation).

Afin de répondre à cette question, nous avons utilisé les **projections issues du scénario moyen** du rapport *World Population Prospects 2024* publié par l’ONU.  
Ce scénario prend en compte une hypothèse **modérée de baisse de la fécondité** et de l’**augmentation de l’espérance de vie**.

Le premier graphique ci-dessous présente les **10 pays** qui connaîtront la **plus forte augmentation de population en valeur absolue** entre 2023 et 2100 *(en millions d’habitants)* :

```{r echo=FALSE, message=FALSE, warning=FALSE}
df <- read_csv("data/WPP2024_Demographic_Indicators_Medium.csv", show_col_types = FALSE)


# Filtrage : uniquement pays, années 2023 & 2100, scénario Medium
df_filtered <- df %>%
  filter(Variant == "Medium", Time %in% c(2023, 2100)) %>%
  filter(LocTypeID == 4) %>%
  select(Country = Location, Year = Time, Population = TPopulation1July)

# Calcul de la croissance et top 10
top10_croissance <- df_filtered %>%
  pivot_wider(names_from = Year, values_from = Population, names_prefix = "Pop_") %>%
  drop_na(Pop_2023, Pop_2100) %>%
  mutate(Croissance = Pop_2100 - Pop_2023) %>%
  arrange(desc(Croissance)) %>%
  slice_head(n = 10)

# Graphique
ggplot(top10_croissance, aes(x = reorder(Country, Croissance), y = Croissance / 1e6)) +
  geom_col(fill = "#2a9d8f") +
  geom_text(aes(label = comma(Croissance / 1e6, accuracy = 0.01)), 
            hjust = -0.1, size = 3.5) +
  coord_flip() +
  labs(
    title = "Top 10 des pays à la plus forte croissance démographique",
    subtitle = "Période : 2023 à 2100 (scénario moyen - ONU WPP 2024)",
    x = "Pays",
    y = "Croissance de la population (en millions d'habitants)",
    caption = "Source : World Population Prospects 2024 - United Nations"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, face = "italic", size = 11),
    axis.text = element_text(size = 10),
    plot.caption = element_text(size = 9, face = "italic")
  ) +
  scale_y_continuous(
    breaks = seq(0, 0.35, 0.05),
    labels = label_comma(accuracy = 0.01),
    expand = expansion(mult = c(0, 0.15))
  )
```

On observe que les **projections confirment largement notre hypothèse** :  
7 des 10 pays affichant la plus forte croissance démographique sont **africains**, avec la **République Démocratique du Congo** en tête (**+325 millions d’habitants**), suivie par le **Pakistan** (**+264 M**) et le **Nigeria** (**+249 M**).  
Ce classement illustre l’importance des **transitions démographiques différées** dans ces régions, ainsi que le **potentiel de croissance massive** qu'elles représentent.

Cette croissance rapide soulève des **enjeux majeurs** : **sécurité alimentaire, urbanisation, emploi, accès à l’éducation et aux soins**…  
Les États devront mettre en place des **politiques ambitieuses** pour accompagner cette évolution, tout en tirant parti de l’opportunité représentée par une **population jeune**.

Pour affiner cette lecture, le graphique suivant représente l’évolution de la population des 3 pays en tête du classement, entre 2023 et 2100.
Il permet de mieux percevoir les écarts de trajectoires, au-delà des seules valeurs finales :

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des données
df <- read_csv("data/WPP2024_Demographic_Indicators_Medium.csv", show_col_types = FALSE)

# Sélection des 3 pays
top3 <- c("Democratic Republic of the Congo", "Pakistan", "Nigeria")

# Préparation des données
df_top3 <- df %>%
  filter(
    Variant == "Medium",
    Location %in% top3,
    Time >= 2023, Time <= 2100
  ) %>%
  select(Année = Time, Pays = Location, Population = TPopulation1July) %>%
  mutate(Population = Population / 1e6)  # conversion en millions

# Données pour les annotations de fin
df_2100 <- df_top3 %>% filter(Année == 2100) %>%
  mutate(
    label = case_when(
      Pays == "Pakistan" ~ "511 M",
      Pays == "Nigeria" ~ "487 M",
      Pays == "Democratic Republic of the Congo" ~ "435 M"
    ),
    vjust = case_when(
      Pays == "Pakistan" ~ -0.5,
      Pays == "Nigeria" ~ 0.5,
      Pays == "Democratic Republic of the Congo" ~ 1.2
    )
  )

# Couleurs personnalisées
couleurs <- c(
  "Democratic Republic of the Congo" = "#e07b39",
  "Pakistan" = "#ea6753",
  "Nigeria" = "#7248b3"
)

# Création du graphique
ggplot(df_top3, aes(x = Année, y = Population, color = Pays)) +
  geom_line(size = 1.2) +
  scale_color_manual(values = couleurs) +
  labs(
    title = "Évolution de la population (Top 3 croissance)",
    subtitle = "Projection démographique 2023–2100 (scénario moyen)",
    x = "Année",
    y = "Population (en millions)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5, size = 16),
    plot.subtitle = element_text(face = "italic", hjust = 0.5, size = 12),
    axis.title = element_text(size = 11),
    legend.title = element_blank(),
    legend.position = "top",
    legend.text = element_text(size = 10),
    plot.margin = margin(10, 30, 10, 10)
  ) +
  geom_text(
    data = df_2100,
    aes(label = label, vjust = vjust),
    hjust = 0,
    size = 4.5,
    show.legend = FALSE
  ) +
  coord_cartesian(clip = "off")
```
La **République Démocratique du Congo** se distingue par une **croissance continue et particulièrement rapide** tout au long du siècle, dépassant largement les **300 millions d’habitants en 2100**.  
À l’inverse, le **Pakistan** et le **Nigeria** présentent des **dynamiques plus modérées**, avec un certain **ralentissement attendu à partir de 2080**.

Ce graphique confirme donc non seulement **l’ampleur des croissances prévues**, mais aussi **la diversité des trajectoires**, reflet des différences en termes de **politiques publiques**, de **développement économique**, de **transition sanitaire**, et de **fécondité**.

En **conclusion**, cette **double analyse visuelle** met en lumière un **basculement potentiel de la carte démographique mondiale** au profit de l’**Afrique subsaharienne**.  
Ces projections incitent à réfléchir dès aujourd’hui aux **politiques à adopter** pour **transformer cette croissance en levier de développement durable**.

### 6. Quel est l'âge médian des populations par pays en 1950 et en 2023 ?
Dans cette partie, nous cherchons à comparer l'âge médian des populations entre 1950 et 2023.
L’objectif est de visualiser le vieillissement démographique à l’échelle mondiale.
Nous observons les différences entre les deux années à l’aide de cartes.

Ces visualisations permettent d’identifier les zones où le vieillissement est le plus marqué.
On s’attend à une hausse de l’âge médian dans la majorité des pays.
Ce vieillissement devrait être particulièrement visible en Europe, en Amérique du Nord et en Asie de l’Est.
```{r echo=FALSE, message=FALSE, warning=FALSE}
# 1. Charger et nettoyer les données d'âge médian
load_and_clean_median_age <- function() {
  file_path <- "data/Dem_1950-2023.xlsx"
  raw_data <- read_excel(file_path, sheet = "Estimates")
  
  # Corriger les noms de colonnes
  colnames(raw_data) <- as.character(raw_data[12, ])
  data <- raw_data[-(1:12), ]
  
  # Nettoyage
  data_clean <- data %>%
    rename(
      Country = `Region, subregion, country or area *`,
      Year = Year,
      MedianAge = `Median Age, as of 1 July (years)`
    ) %>%
    mutate(
      Year = as.character(Year),
      MedianAge = as.numeric(MedianAge)
    )
  
  return(data_clean)
}

# 2. Filtrer pour l'année 2023 et pays uniquement
filter_median_age_2023 <- function(data) {
  data %>%
    filter(grepl("^[A-Za-z]", Country)) %>%
    filter(Year == "2023", !is.na(MedianAge))
}

# 3. Charger la carte du monde
load_world_map <- function() {
  map_data("world") %>% rename(Country_map = region)
}

# 4. Harmoniser les noms de pays (partiel, à ajuster au besoin)
harmonize_country_names <- function(df) {
  df %>%
    mutate(Country = case_when(
      Country == "United States of America" ~ "USA",
      Country == "United Kingdom" ~ "UK",
      Country == "Democratic Republic of the Congo" ~ "Democratic Republic of Congo",
      Country == "Côte d’Ivoire" ~ "Ivory Coast",
      Country == "Viet Nam" ~ "Vietnam",
      Country == "Russian Federation" ~ "Russia",
      Country == "Syrian Arab Republic" ~ "Syria",
      Country == "Republic of Korea" ~ "South Korea",
      Country == "Republic of Moldova" ~ "Moldova",
      Country == "Iran (Islamic Republic of)" ~ "Iran",
      Country == "Lao People's Democratic Republic" ~ "Laos",
      Country == "Venezuela (Bolivarian Republic of)" ~ "Venezuela",
      TRUE ~ Country
    ))
}

# 5. Fusionner les cartes
prepare_map_data <- function(map_df, median_df) {
  left_join(map_df, median_df, by = c("Country_map" = "Country"))
}

# 6. Tracer la carte
plot_median_age_map <- function(map_data) {
  ggplot(map_data, aes(long, lat, group = group, fill = MedianAge, 
                       text = paste0(Country_map, "<br>Âge médian : ", MedianAge))) +
    geom_polygon(color = "gray80", size = 0.2) +
    scale_fill_viridis_c(option = "plasma", direction = -1, name = "Âge médian") +
    theme_void() +
    labs(title = "Âge Médian par Pays en 2023") +
    theme(
      plot.title = element_text(hjust = 0.5, face = "bold"),
      legend.title = element_text(size = 10, face = "bold"),
      legend.text = element_text(size = 8)
    )
}

# 7. Exécution complète
median_age_data <- load_and_clean_median_age()
median_age_2023 <- filter_median_age_2023(median_age_data) %>%
  harmonize_country_names()

world_map <- load_world_map()
map_final <- prepare_map_data(world_map, median_age_2023)

# 9. Filtrer les données pour 1950
filter_median_age_1950 <- function(data) {
  data %>%
    filter(grepl("^[A-Za-z]", Country)) %>%
    filter(Year == "1950", !is.na(MedianAge))
}

# 10. Carte 1950
median_age_1950 <- filter_median_age_1950(median_age_data) %>%
  harmonize_country_names()

map_1950 <- prepare_map_data(world_map, median_age_1950)

# 11. Fonction modifiée pour titre personnalisable
plot_median_age_map_year <- function(map_data, year) {
  ggplot(map_data, aes(long, lat, group = group, fill = MedianAge, 
                       text = paste0(Country_map, "<br>Âge médian : ", MedianAge))) +
    geom_polygon(color = "gray80", size = 0.2) +
    scale_fill_viridis_c(option = "plasma", direction = -1, name = "Âge médian") +
    theme_void() +
    labs(title = paste("Âge Médian par Pays en", year)) +
    theme(
      plot.title = element_text(hjust = 0.5, face = "bold"),
      legend.title = element_text(size = 10, face = "bold"),
      legend.text = element_text(size = 8)
    )
}

# 12. Affichage interactif des deux cartes
plot_1950 <- ggplotly(plot_median_age_map_year(map_1950, "1950"), tooltip = "text")
plot_2023 <- ggplotly(plot_median_age_map_year(map_final, "2023"), tooltip = "text")

# 13. Affichage côte à côte (si HTML / Shiny ou en deux blocs)
plot_1950
plot_2023

```
En Europe, l’augmentation est nette. Dans de nombreux pays, l’âge médian a progressé de plus de 15 ans. Cela s’explique par la baisse de la natalité et l’allongement de l’espérance de vie.
Cependant, certains pays comme la Suède montrent une hausse plus modérée. Par exemple, l’âge médian est passé de 33 ans à 39 ans seulement. Cela peut être dû à un équilibre démographique plus stable dès les années 1950.

En Amérique du Nord, les États-Unis et le Canada suivent une tendance similaire à celle de l’Europe.

En Asie, des pays comme le Japon et la Corée du Sud affichent une hausse très marquée, en lien avec leur transition démographique rapide.

En Afrique, on constate deux dynamiques différentes.
Dans les pays d’Afrique du Nord, l’âge médian a aussi fortement progressé.
En revanche, dans les pays du Sahel, l’évolution est bien plus lente, voire inexistante. Au Niger, l’âge médian est resté très bas : 13 ans en 1950, 15 ans en 2023.
Certains pays comme le Tchad ou la République centrafricaine ont même vu leur âge médian baisser. C’est un signal fort qui pourrait s’expliquer par une croissance rapide de la population jeune, liée à une fécondité très élevée, des conflits, ou des conditions sanitaires difficiles.

Même constat en Afghanistan, où l’âge médian semble avoir diminué sur la période.


### 7. Évolution de l’espérance de vie à la naissance dans le monde (1950–2100)

Nous avons émis l’hypothèse que l’espérance de vie à la naissance augmente de manière continue à l’échelle mondiale depuis 1950. Cette progression serait principalement due aux avancées médicales (vaccins, antibiotiques, chirurgie), à l’amélioration de l’hygiène, à la diminution de la mortalité infantile, à une meilleure nutrition, et plus largement, à la transition épidémiologique.
Nous supposons également que cette croissance se poursuivra jusqu’en 2100, mais à un rythme ralenti, car les gains deviennent plus difficiles à mesure que l'on approche des limites biologiques humaines.

Pour confronter cette hypothèse à la réalité des données, nous avons sélectionné les projections issues du scénario moyen (Medium) fournies par la base World Population Prospects 2024 de l’ONU, couvrant l’évolution mondiale de l’espérance de vie de 1950 à 2100.

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des données
df <- read_csv("data/WPP2024_Demographic_Indicators_Medium.csv", show_col_types = FALSE)

# Filtrage pour le monde, scénario moyen
df_life <- df %>%
  filter(Location == "World", Variant == "Medium") %>%
  select(Année = Time, EsperanceVie = LEx) %>%
  filter(!is.na(EsperanceVie))

# Réduire les points visibles à tous les 5 ans
df_points <- df_life %>% filter(Année %% 5 == 0)

# Tracer le graphique
ggplot(df_life, aes(x = Année, y = EsperanceVie)) +
  geom_line(color = "#264653", linewidth = 1.2) +
  geom_point(data = df_points, aes(x = Année, y = EsperanceVie), 
             shape = 21, fill = "white", color = "#264653", size = 2) +
  
  # Séparation historique / projections
  geom_vline(xintercept = 2023, linetype = "dashed", color = "gray40") +
  annotate("text", x = 1985, y = 87, label = "Historique", size = 4, fontface = "bold") +
  annotate("text", x = 2060, y = 87, label = "Projections", size = 4, fontface = "bold") +
  
  # Annotations ajustées
  annotate("text", x = 1955, y = 45.3, label = "47 ans (1950)", hjust = 0, size = 3.5, color = "#264653") +
  annotate("text", x = 2085, y = 83, label = "82 ans (2100)", hjust = 1, size = 3.5, color = "#264653") +
  
  # Titres et axes
  labs(
    title = "Évolution de l'espérance de vie à la naissance dans le monde",
    subtitle = "Période : 1950 à 2100 — scénario moyen (ONU WPP 2024)",
    x = "Année",
    y = "Espérance de vie (en années)",
    caption = "Source : World Population Prospects 2024 - United Nations"
  ) +
  theme_classic() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 15, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 11, face = "italic"),
    axis.title = element_text(size = 12, face = "bold"),
    axis.text = element_text(size = 11),
    plot.caption = element_text(size = 9, face = "italic")
  ) +
  scale_y_continuous(labels = comma, limits = c(45, 90)) +
  scale_x_continuous(breaks = seq(1950, 2100, 10))
```
Le graphique obtenu confirme clairement notre hypothèse :

En 1950, l’espérance de vie mondiale à la naissance s’élevait à 47 ans.
En 2023, elle atteint environ 73 ans, soit un gain impressionnant de 26 ans en un peu plus de 70 ans.
D’ici 2100, les projections estiment qu’elle atteindra 82 ans, traduisant une hausse supplémentaire de 9 ans en 77 ans.

On distingue deux grandes phases dans cette évolution :

. Une croissance rapide entre 1950 et 2015, principalement portée par les pays en développement, grâce à la réduction de la mortalité infantile, à la généralisation des campagnes de vaccination, à l’accès élargi aux soins de santé primaires, et à l’amélioration des conditions de vie.

. Un ralentissement à partir de 2025, correspondant à un palier dans la majorité des régions du monde. Les gains deviennent plus difficiles à obtenir, car ils dépendent désormais de la prévention des maladies chroniques, de la prise en charge du vieillissement et des innovations médicales avancées.

On observe également un léger recul autour de 2020, probablement imputable à la pandémie de COVID-19, qui a temporairement fait baisser l’espérance de vie dans de nombreuses régions.

Cette visualisation met en évidence l’amélioration spectaculaire des conditions sanitaires et sociales au niveau mondial au cours des 70 dernières années, tout en rappelant que les défis futurs reposeront moins sur la survie de la petite enfance que sur le maintien d’une bonne santé à un âge avancé.

En résumé, les projections de l’ONU valident pleinement notre hypothèse initiale :
L’espérance de vie à la naissance a connu une augmentation rapide depuis 1950, et devrait continuer à progresser jusqu’en 2100, bien que plus lentement.


### 8. Quels sont les 10 pays avec les soldes migratoires nets les plus élevés et les plus faibles entre 2000 et 2023 ?
Nous formulons l'hypothèse que les migrations internationales suivent des patterns économiques et géopolitiques clairs.  
Les pays développés à forte croissance économique (États-Unis, Allemagne, pays du Golfe) devraient présenter des soldes migratoires positifs élevés, attirant une main-d'œuvre qualifiée et des populations en quête de meilleures opportunités.  
À l'inverse, les pays en développement ou en situation de crise (conflits, instabilité économique) devraient afficher des soldes négatifs importants, traduisant une émigration nette de leur population.  
Nous nous attendons également à observer l'impact des politiques migratoires et des événements géopolitiques sur ces flux.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des bibliothèques
library(readxl)
library(dplyr)
library(ggplot2)
library(forcats)

# 1. Importation des données
data <- readxl::read_excel("data/Dem_1950-2023.xlsx", skip = 16)

# 2. Sélection des colonnes utiles
data <- data %>%
  select(
    country = `Region, subregion, country or area *`,
    year = Year,
    net_migration = `Net Number of Migrants (thousands)`
  ) %>%
  mutate(
    year = as.numeric(year),
    net_migration = as.numeric(gsub(",", "", net_migration))
  )

# 3. Suppression des agrégats régionaux
agrégats <- c(
  "World", "More developed regions", "Less developed regions",
  "Least developed countries", "Less developed regions, excluding least developed countries",
  "High-income countries", "Middle-income countries", "Upper-middle-income countries",
  "Lower-middle-income countries", "Low-income countries", "Low-and-middle-income countries",
  "Less developed regions, excluding China", "High-and-upper-middle-income countries",
  "Low-and-Lower-middle-income countries", "Europe, Northern America, Australia, and New Zealand",
  "Land-locked Developing Countries (LLDC)", "LLDC: Africa", "LLDC: Asia",
  "Sub-Saharan Africa", "Northern Africa and Western Asia", "Central and Southern Asia",
  "Eastern and South-Eastern Asia", "Latin America and the Caribbean", "Oceania",
  "Europe and Northern America", "Asia", "Africa", "Europe", "Northern America",
  "Caribbean", "Central America", "South America", "Eastern Europe", "Northern Europe",
  "Southern Europe", "Western Europe", "Eastern Africa", "Middle Africa",
  "Northern Africa", "Southern Africa", "Western Africa", "Western Asia",
  "Eastern Asia", "South-Eastern Asia", "Southern Asia", "Melanesia",
  "Micronesia", "Polynesia", "No income group available"
)

data <- data %>% filter(!country %in% agrégats)

# 4. Agrégation du solde migratoire net par pays (2000-2023)
migration_summary <- data %>%
  filter(year >= 2000 & year <= 2023) %>%
  group_by(country) %>%
  summarise(SoldeMigratoireTotal = sum(net_migration, na.rm = TRUE)) %>%
  arrange(desc(SoldeMigratoireTotal))

# 5. Sélection des 10 plus et 10 moins
top_10_plus <- head(migration_summary, 10)
top_10_moins <- tail(migration_summary, 10)

# 6. Préparation des données pour le graphique
combined_data <- bind_rows(
  top_10_plus %>% mutate(Category = "Immigration nette"),
  top_10_moins %>% mutate(Category = "Émigration nette")
) %>%
  mutate(
    country = forcats::fct_reorder(country, SoldeMigratoireTotal),
    SoldeMigratoireMillions = SoldeMigratoireTotal / 1000,
    ColorGroup = ifelse(SoldeMigratoireTotal > 0, "Positif", "Négatif")
  )

# 7. Visualisation miroir : immigration à droite, émigration à gauche
combined_data_mirror <- combined_data %>%
  mutate(
    ValeurAffichee = ifelse(ColorGroup == "Négatif", -SoldeMigratoireMillions, SoldeMigratoireMillions),
    country = fct_reorder(country, ValeurAffichee)
  )

ggplot(combined_data_mirror, aes(x = ValeurAffichee, y = country, fill = ColorGroup)) +
  geom_col(width = 0.6, alpha = 0.95) +
  geom_text(
    aes(label = paste0(round(abs(ValeurAffichee), 1), "M")),
    hjust = ifelse(combined_data_mirror$ValeurAffichee > 0, -0.1, 1.1),
    size = 3,
    fontface = "bold",
    color = "#2C3E50"
  ) +
  scale_fill_manual(
    values = c("Positif" = "#2A9D8F", "Négatif" = "#E63946"),
    name = "Type de migration"
  ) +
  labs(
    title = "Solde migratoire net cumulé par pays (2000–2023)",
    x = "Solde migratoire net (millions)",
    y = "",
    caption = "Source : World Population Prospects 2024"
  ) +
  theme_minimal(base_size = 10) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, color = "#7F8C8D"),
    axis.text.y = element_text(face = "bold"),
    axis.text.x = element_text(size = 9),
    legend.position = "top"
  ) +
  scale_x_continuous(labels = abs, expand = expansion(mult = c(0.1, 0.1)))



```
Le graphique révèle des patterns migratoires cohérents avec nos hypothèses de départ.  

**Pays à forte immigration nette :** Les États-Unis dominent largement avec un solde positif dépassant les autres pays, confirmant leur statut de principale destination migratoire mondiale. L'Allemagne, le Royaume-Uni et les pays du Golfe (Émirats Arabes Unis, Arabie Saoudite) figurent également parmi les destinations privilégiées, reflétant leur attractivité économique et leurs besoins en main-d'œuvre.

**Pays à forte émigration nette :** Les résultats mettent en évidence des pays confrontés à des défis économiques, politiques ou démographiques majeurs. La présence de pays comme la Syrie ou l'Afghanistan illustre l'impact des conflits armés sur les flux migratoires, tandis que d'autres pays reflètent des dynamiques économiques poussant leur population à émigrer.

Cette analyse souligne le rôle central des inégalités de développement, des politiques migratoires et des événements géopolitiques dans la structuration des flux migratoires internationaux sur les deux dernières décennies.

### 9. Existe-t-il une corrélation entre le taux de mortalité infantile et le taux de fécondité total (TFR) en 2023 ?

Nous formulons l'hypothèse qu'il existe une corrélation positive forte entre le taux de mortalité infantile et le taux de fécondité total.
Cette hypothèse s'appuie sur la théorie de la transition démographique : dans les sociétés où la mortalité infantile est élevée, les familles tendent à avoir plus d'enfants pour compenser les risques de décès prématurés et assurer leur descendance.
À l'inverse, dans les pays développés où la mortalité infantile est faible, les familles peuvent se permettre d'avoir moins d'enfants tout en étant assurées de leur survie.
Cette relation pourrait également refléter des facteurs socio-économiques communs : accès limité aux soins de santé, éducation, planning familial, et conditions de vie précaires.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Chargement des bibliothèques nécessaires
library(readr)
library(dplyr)
library(ggplot2)
library(plotly)

# Chargement des données
df <- read_csv("data/WPP2024_Demographic_Indicators_Medium.csv", show_col_types = FALSE)

# Filtrage pour l'année 2023 et la variante Medium
df_2023 <- df %>%
  filter(Variant == "Medium", Time == 2023) %>%
  select(Location, IMR, TFR) %>%
  filter(!is.na(IMR), !is.na(TFR)) %>%
  # Suppression des agrégats régionaux
  filter(!Location %in% c(
    "World", "More developed regions", "Less developed regions",
    "Least developed countries", "Sub-Saharan Africa", "Northern Africa and Western Asia",
    "Central and Southern Asia", "Eastern and South-Eastern Asia", "Europe and Northern America",
    "Latin America and the Caribbean", "Oceania", "Asia", "Africa", "Europe",
    "Northern America", "Caribbean", "Central America", "South America"
  ))

# Calcul du coefficient de corrélation
correlation_coefficient <- cor(df_2023$IMR, df_2023$TFR, use = "complete.obs")

# Création du graphique de corrélation
p <- ggplot(df_2023, aes(x = IMR, y = TFR)) +
  geom_point(alpha = 0.7, size = 2, color = "#2A9D8F") +
  geom_smooth(method = "lm", se = TRUE, color = "#E63946", fill = "#E63946", alpha = 0.2) +
  labs(
    title = paste("Corrélation entre Mortalité Infantile et Taux de Fécondité (2023)"),
    subtitle = paste("Coefficient de corrélation r =", round(correlation_coefficient, 3)),
    x = "Taux de mortalité infantile (pour 1000 naissances vivantes)",
    y = "Taux de fécondité total (TFR)",
    caption = "Source : World Population Prospects 2024 | Chaque point représente un pays"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12, color = "#7F8C8D"),
    axis.title = element_text(size = 11),
    axis.text = element_text(size = 10),
    plot.caption = element_text(size = 9, color = "#7F8C8D")
  )

# Affichage du graphique
print(p)

# Identification des pays extrêmes
pays_tfr_eleve <- df_2023 %>% arrange(desc(TFR)) %>% head(5)
pays_imr_eleve <- df_2023 %>% arrange(desc(IMR)) %>% head(5)
pays_tfr_faible <- df_2023 %>% arrange(TFR) %>% head(5)
pays_imr_faible <- df_2023 %>% arrange(IMR) %>% head(5)

cat("Pays avec TFR le plus élevé:\n")
print(pays_tfr_eleve[c("Location", "TFR", "IMR")])

cat("\nPays avec IMR le plus élevé:\n")
print(pays_imr_eleve[c("Location", "IMR", "TFR")])

# Statistiques descriptives
cat(paste("\nCoefficient de corrélation de Pearson:", round(correlation_coefficient, 4)))
cat(paste("\nNombre de pays analysés:", nrow(df_2023)))
```
Le graphique met en évidence une forte corrélation positive entre le taux de mortalité infantile et le taux de fécondité total en 2023, avec un coefficient de corrélation de **r = 0,867**. Cela signifie que, de manière générale, plus la mortalité infantile est élevée dans un pays, plus les femmes ont tendance à avoir un nombre élevé d’enfants. Cette relation s'explique notamment par des facteurs socio-économiques : dans les pays où la mortalité infantile reste importante, les familles ont souvent davantage d’enfants pour compenser les pertes potentielles, en l’absence de systèmes de santé ou de protection sociale efficaces. À l’inverse, dans les pays développés où la mortalité infantile est très faible, le taux de fécondité tend également à diminuer en raison de la sécurité sanitaire, de l'accès à l'éducation, et d'autres facteurs liés à la transition démographique. Le graphique reflète donc un schéma global bien connu dans les dynamiques de développement.

<a id="section-5"></a>

## IV. Annexe

Pour la réalisation de ce projet, nous nous sommes réparties les taches de la manière suivante : 

* Tous les membres du groupe ont travaillé conjointement sur la rédaction de la proposition Read.Me.
* En ce qui concerne la partie exploration nous nous sommes répartis les questions de la manière suivante :
	
	+ `Robin :` **1.** Comment le taux de fécondité total (TFR) a-t-il évolué entre 1950 et 2023 dans les cinq continents ?  
  
  + `Othmane :` **2.** Quels sont les 10 pays ayant connu les plus fortes croissances et décroissances démographiques entre 1950 et 2023 ?  
  **6.** Quel est l'âge médian des populations par pays en 1950 et en 2023 ?  
  **ShinyApp**    
  + `Nicolas :` **3.** Quels sont les 10 pays avec les taux de mortalité infantile les plus faibles et les plus élevés en moyenne entre 2000 et 2023 ?
  + `Zakaria :` **4.** Quels sont les 10 pays représentant la plus forte part de la population mondiale en 2023 ?  
  **8.**  Quels sont les 10 pays avec les soldes migratoires nets les plus élevés et les plus faibles entre 2000 et 2023 ?    
  **9.**  Existe-t-il une corrélation entre le taux de mortalité infantile et le taux de fécondité total (TFR) en 2023 ?
               

  
